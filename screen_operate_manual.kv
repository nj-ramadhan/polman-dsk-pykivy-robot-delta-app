#:kivy 2.1.0

<ScreenOperateManual>:
    MDBoxLayout:
        orientation: "vertical"

		# header layout
        MDBoxLayout:
            id: header_layout
            orientation: "horizontal"
            padding: 20
			size_hint_y: 0.1
                    
            Image:
                id: logo_polman
                source:'asset/logo_polman.png'
                size_hint_x: 0.25
                allow_stretch: True 

			MDBoxLayout:
				orientation: "vertical"

				MDLabel:
					id: subtitle            
					text: "POLeDELTA ROBOT CONTROL"
					halign: "center"
					valign: "middle"
					font_style: 'H5'

				MDLabel:
					id: comm_status
					text: "Status:"
					halign: "center"
					valign: "middle"
                  
            Image:
                id: logo_ae
                source:'asset/logo_ae.png'
                size_hint_x: 0.25
                allow_stretch: True   

		# title layout
		MDBoxLayout:
			id: layout_title
			orientation: "horizontal"
			size_hint_y: 0.05

			MDIconButton:
				id: bt_menu
				icon: "menu"
				size_hint_x: 0.2
				on_press: root.screen_main_menu()

			MDLabel:
				text: "OPERATE MANUAL"
				halign: "center"
				valign: "middle"
				font_style: 'H6'

			MDIconButton:
				id: bt_shutdown
				icon: "power"
				size_hint_x: 0.2
				on_press: root.exec_shutdown()

		# manual operate layout
		MDBoxLayout:
			id: layout_operate_manual
			orientation: "vertical"
			size_hint_y: 0.80
			padding:20
			spacing:10

			# delta robot illustration
			MDBoxLayout:
				orientation: "horizontal"
				size_hint_y: 0.60

				MDBoxLayout:
					id: delta_robot_illustration
					
				MDGridLayout:
					cols:1
					spacing:10
					size_hint_x: 0.2

					MDFillRoundFlatIconButton:
						text: "TOP"
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_graph(90, -90, 0)

					MDFillRoundFlatIconButton:
						text: "FRONT"
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_graph(0, 0, 0)

					MDFillRoundFlatIconButton:
						text: "SIDE"
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_graph(0, -90, 0)

					MDFillRoundFlatIconButton:
						text: "ISOMETIC"
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_graph()

					MDFillRoundFlatIconButton:
						icon: "arrow-up-bold"
						text: " "
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_view(0)

					MDFillRoundFlatIconButton:
						icon: "arrow-down-bold"
						text: " "
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_view(1)

					MDFillRoundFlatIconButton:
						icon: "arrow-left-bold"
						text: " "
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_view(2)

					MDFillRoundFlatIconButton:
						icon: "arrow-right-bold"
						text: " "
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_view(3)

			MDBoxLayout:
				orientation: "horizontal"
				size_hint_y: 0.05
				spacing: 20
				padding: 20

				MDFillRoundFlatButton:
					id: bt_mode
					text: "MODE MANUAL"
					font_style: 'Button'
					size_hint_x: 0.3
					on_press: root.exec_mode()

				MDFillRoundFlatButton:
					id: bt_origin
					text: "ORIGIN"
					font_style: 'Button'
					size_hint_x: 0.3
					on_press: root.exec_origin()
					on_release: root.end_origin()

				MDFillRoundFlatButton:
					id: bt_reset
					text: "RESET"
					font_style: 'Button'
					size_hint_x: 0.3
					on_press: root.exec_reset()
					on_release: root.end_reset()

			MDBoxLayout:
				orientation: "horizontal"
				size_hint_y: 0.39
				spacing: 10
				padding: 20

				MDBoxLayout:
					orientation: "vertical"
					size_hint_x: 0.6
					padding: 20
					spacing: 10

					MDFillRoundFlatButton:
						id: bt_jog_enable
						size_hint_y: 0.01
						text: "JOG"
						font_style: 'Button'
						size_hint_x: 1
						on_press: root.exec_jog_enable()
						
					MDGridLayout:
						cols:3
						spacing:10

						MDFillRoundFlatButton:
							id: bt_jog_x_p
							text: "X +"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_x_p()
							on_release: root.end_jog_x()

						MDFillRoundFlatButton:
							id: bt_jog_y_p
							text: "Y +"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_y_p()
							on_release: root.end_jog_y()

						MDFillRoundFlatButton:
							id: bt_jog_z_p
							text: "Z +"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_z_p()
							on_release: root.end_jog_z()

						MDFillRoundFlatButton:
							id: bt_jog_x_n
							text: "X -"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_x_n()
							on_release: root.end_jog_x()

						MDFillRoundFlatButton:
							id: bt_jog_y_n
							text: "Y -"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_y_n()
							on_release: root.end_jog_y()

						MDFillRoundFlatButton:
							id: bt_jog_z_n
							text: "Z -"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_z_n()
							on_release: root.end_jog_z()

						MDFillRoundFlatButton:
							id: bt_jog_j1_p
							text: "JOINT1 +"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_j1_p()
							on_release: root.end_jog_j1()

						MDFillRoundFlatButton:
							id: bt_jog_j2_p
							text: "JOINT2 +"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_j2_p()
							on_release: root.end_jog_j2()

						MDFillRoundFlatButton:
							id: bt_jog_j3_p
							text: "JOINT3 +"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_j3_p()
							on_release: root.end_jog_j3()

						MDFillRoundFlatButton:
							id: bt_jog_j1_n
							text: "JOINT1 -"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_j1_n()
							on_release: root.end_jog_j1()

						MDFillRoundFlatButton:
							id: bt_jog_j2_n
							text: "JOINT2 -"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_j2_n()
							on_release: root.end_jog_j2()

						MDFillRoundFlatButton:
							id: bt_jog_j3_n
							text: "JOINT3 -"
							font_style: 'Button'
							size_hint_x: 0.3
							on_press: root.exec_jog_j3_n()
							on_release: root.end_jog_j3()

				MDBoxLayout:
					orientation: "horizontal"
					size_hint_x: 0.4
					padding: 20
					spacing: 10

					MDGridLayout:
						cols:2
						spacing:10

						MDTextField:
							id: input_operate_x
							hint_text: "Input X coordinate (mm)"
							font_style: 'Body1'
							input_filter: 'float'
							on_text_validate: root.update_cartesian()
						
						MDFillRoundFlatButton:
							id: bt_operate_x
							text: "EXECUTE"
							font_style: 'Button'
							size_hint_x: 0.2
							on_press: root.exec_operate_x()
							on_release: root.end_operate_x()

						MDTextField:
							id: input_operate_y
							hint_text: "Input Y coordinate (degree)"
							font_style: 'Body1'
							input_filter: 'float'
							on_text_validate: root.update_cartesian()
						
						MDFillRoundFlatButton:
							id: bt_operate_y
							text: "EXECUTE"
							font_style: 'Button'
							size_hint_x: 0.2
							on_press: root.exec_operate_y()
							on_release: root.end_operate_y()

						MDTextField:
							id: input_operate_z
							hint_text: "Input Z coordinate (degree)"
							font_style: 'Body1'
							input_filter: 'float'
							on_text_validate: root.update_cartesian()
						
						MDFillRoundFlatButton:
							id: bt_operate_z
							text: "EXECUTE"
							font_style: 'Button'
							size_hint_x: 0.2
							on_press: root.exec_operate_z()
							on_release: root.end_operate_z()

					MDGridLayout:
						cols:2
						spacing:10

						MDTextField:
							id: input_operate_j1
							hint_text: "Input J1 angle"
							font_style: 'Body1'
							input_filter: 'float'
							on_text_validate: root.update_joint()
						
						MDFillRoundFlatButton:
							id: bt_operate_j1
							text: "EXECUTE"
							font_style: 'Button'
							size_hint_x: 0.2
							on_press: root.exec_operate_j1()
							on_release: root.end_operate_j1()

						MDTextField:
							id: input_operate_j2
							hint_text: "Input J2 angle"
							font_style: 'Body1'
							input_filter: 'float'
							on_text_validate: root.update_joint()
						
						MDFillRoundFlatButton:
							id: bt_operate_j2
							text: "EXECUTE"
							font_style: 'Button'
							size_hint_x: 0.2
							on_press: root.exec_operate_j2()
							on_release: root.end_operate_j2()

						MDTextField:
							id: input_operate_j3
							hint_text: "Input Z coordinate (degree)"
							font_style: 'Body1'
							input_filter: 'float'
							on_text_validate: root.update_joint()
						
						MDFillRoundFlatButton:
							id: bt_operate_j3
							text: "EXECUTE"
							font_style: 'Button'
							size_hint_x: 0.2
							on_press: root.exec_operate_j3()
							on_release: root.end_operate_j3()

		# MDRectangleFlatIconButton: navigation operation
		MDBoxLayout:
			orientation: "horizontal"
			size_hint_y: 0.05
			padding:20
			spacing:20

			MDFillRoundFlatIconButton:
				id: bt_screen_manual
				icon: "controller-classic"
				text: "MANUAL OPERATION"
				font_style: 'H6'
				size_hint_x: 0.5
				on_press: root.screen_operate_manual()
			
			MDFillRoundFlatIconButton:
				id: bt_screen_auto
				icon: "console"
				text: "AUTOMATIC OPERATION"
				font_style: 'H6'
				size_hint_x: 0.5
				on_press: root.screen_operate_auto()		

